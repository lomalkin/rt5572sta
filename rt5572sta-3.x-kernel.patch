diff --git a/old/common/cmm_mac_usb.c b/new/common/cmm_mac_usb.c
index 11f9bdd..b57ac61 100644
--- a/old/common/cmm_mac_usb.c
+++ b/new/common/cmm_mac_usb.c
@@ -26,8 +26,8 @@
 
 
 #ifdef RTMP_MAC_USB
-
-
+#define usb_buffer_alloc(a, b, c, d) usb_alloc_coherent(a, b, c, d)
+#define usb_buffer_free(a, b, c, d) usb_free_coherent(a, b, c, d)
 #include	"rt_config.h"
 
 
diff --git a/old/common/cmm_wpa.c b/new/common/cmm_wpa.c
index e966c9f..04ef1c8 100644
--- a/old/common/cmm_wpa.c
+++ b/new/common/cmm_wpa.c
@@ -1816,17 +1816,17 @@ int RtmpPasswordHash(PSTRING password, PUCHAR ssid, INT ssidlength, PUCHAR outpu
 	Return Value:
 
 	Note:
-		Output ¡ö KDF-Length (K, label, Context) where
+		Output \A1\F6 KDF-Length (K, label, Context) where
 		Input:    K, a 256-bit key derivation key
 				  label, a string identifying the purpose of the keys derived using this KDF
 				  Context, a bit string that provides context to identify the derived key
 				  Length, the length of the derived key in bits
 		Output: a Length-bit derived key
 
-		result ¡ö ""
-		iterations ¡ö (Length+255)/256 
+		result \A1\F6 ""
+		iterations \A1\F6 (Length+255)/256 
 		do i = 1 to iterations
-			result ¡ö result || HMAC-SHA256(K, i || label || Context || Length)
+			result \A1\F6 result || HMAC-SHA256(K, i || label || Context || Length)
 		od
 		return first Length bits of result, and securely delete all unused bits
 
@@ -2493,7 +2493,7 @@ VOID RTMPMakeRSNIE(
 	UCHAR		PrimaryRsnie;			
 	BOOLEAN		bMixCipher = FALSE;	/* indicate the pairwise and group cipher are different*/
 	UCHAR		p_offset;		
-	WPA_MIX_PAIR_CIPHER		FlexibleCipher = MIX_CIPHER_NOTUSE;	/* it provide the more flexible cipher combination in WPA-WPA2 and TKIPAES mode*/
+	WPA_MIX_PAIR_CIPHER		FlexibleCipher = WPA_TKIPAES_WPA2_TKIPAES;	/* it provide the more flexible cipher combination in WPA-WPA2 and TKIPAES mode*/
 		
 	rsnielen_cur_p = NULL;
 	rsnielen_ex_cur_p = NULL;
diff --git a/old/os/linux/config.mk b/new/os/linux/config.mk
index ad23709..1e0981f 100644
--- a/old/os/linux/config.mk
+++ b/new/os/linux/config.mk
@@ -23,7 +23,7 @@ HAS_APCLI=n
 
 # Support Wpa_Supplicant
 # i.e. wpa_supplicant -Dralink
-HAS_WPA_SUPPLICANT=n
+HAS_WPA_SUPPLICANT=y
 
 
 # Support Native WpaSupplicant for Network Maganger
@@ -32,7 +32,7 @@ HAS_WPA_SUPPLICANT=n
 # what if user want to use wpa_supplicant to serve P2P function/feature, 
 # in case, it must use Ralink Propriectary wpa_supplicant to do.
 # and this compile flag will report P2P Related Event to Ralink wpa_supplicant.
-HAS_NATIVE_WPA_SUPPLICANT_SUPPORT=n
+HAS_NATIVE_WPA_SUPPLICANT_SUPPORT=y
 
 #Support Net interface block while Tx-Sw queue full
 HAS_BLOCK_NET_IF=n
diff --git a/old/os/linux/rt_linux.c b/new/os/linux/rt_linux.c
index 8cde988..29fbc52 100644
--- a/old/os/linux/rt_linux.c
+++ b/new/os/linux/rt_linux.c
@@ -510,9 +510,9 @@ PNDIS_PACKET duplicate_pkt(
 		MEM_DBG_PKT_ALLOC_INC(skb);
 
 		skb_reserve(skb, 2);
-		NdisMoveMemory(skb->tail, pHeader802_3, HdrLen);
+		NdisMoveMemory(skb_tail_pointer(skb), pHeader802_3, HdrLen);
 		skb_put(skb, HdrLen);
-		NdisMoveMemory(skb->tail, pData, DataSize);
+		NdisMoveMemory(skb_tail_pointer(skb), pData, DataSize);
 		skb_put(skb, DataSize);
 		skb->dev = pNetDev;	/*get_netdev_from_bssid(pAd, FromWhichBSSID); */
 		pPacket = OSPKT_TO_RTPKT(skb);
diff --git a/old/tools/bin2h b/new/tools/bin2h
old mode 100755
new mode 100644
